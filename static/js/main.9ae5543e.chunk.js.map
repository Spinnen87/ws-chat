{"version":3,"sources":["components/User.js","components/Message.js","components/Chat.js","components/SendMessage.js","components/Login.js","utils.js","components/App.js","index.js"],"names":["User","status","userName","handleLogOut","className","slice","type","onClick","Message","from","message","time","user","date","moment","calendar","Chat","props","divChatMessages","React","createRef","this","current","scrollTop","scrollHeight","ref","messages","map","item","key","id","Component","SendMessage","state","inputValue","textInputChange","e","setState","target","value","placeholder","onChange","preventDefault","handleClick","Login","changeInput","handleSingIn","notify","Notification","permission","notification","tag","setTimeout","close","bind","onclick","window","open","process","requestPermission","App","notifications","ws","ReconnectingWebSocket","connectionTimeout","localStorage","setItem","JSON","stringify","clear","send","parse","getItem","onopen","console","log","onmessage","concat","data","reverse","onclose","wasClean","code","reason","onerror","error","onfocus","onblur","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.9ae5543e.chunk.js","sourcesContent":["import React from 'react';\n\nfunction User({ status, userName, handleLogOut }) {\n    return (\n        <div className=\"user\" >\n            <div\n                className={status ? 'user__avatar connect' : 'user__avatar disconnect'}\n            >\n                {userName.slice(0, 1)}\n            </div>\n            <div className='user-info'>\n                <div className='user-info__name'>{userName}</div>\n                <div className='user-info__connect-status'>{status ? 'connect' : 'disconnect'}</div>\n            </div>\n            <div>\n                <button type=\"button\" className='btn-sing-out fas fa-sign-out-alt' onClick={handleLogOut} />\n            </div>\n        </div>\n    );\n}\n\nexport default User;\n","import React from 'react';\nimport moment from 'moment';\n\nfunction Message({ from, message, time, user }) {\n\n    let date = `${new moment(time).calendar()}`;\n    return (\n\n        <div className={user === from ? \"message message_rigth\" : \"message\"}>\n            <div>\n                {\n                    user === from ?\n                        <p className='message__date'>{date}\n                            <span className='message__avtor'> {from}</span>\n                        </p>\n                        :\n                        <p className='message__avtor'>{from}\n                            <span className='message__date'> {date}</span>\n                        </p>\n                }\n            </div>\n            <div className='message__body'>{message}</div>\n        </div>\n    );\n}\n\nexport default Message;\n","import React, { Component } from 'react';\nimport Message from './Message';\n\nexport default class Chat extends Component {\n    constructor(props) {\n        super(props);\n\n        this.divChatMessages = React.createRef();\n    };\n\n    componentDidUpdate() {\n        this.divChatMessages.current.scrollTop = this.divChatMessages.current.scrollHeight;\n    }\n\n    render() {\n        return (\n            <div className=\"chat\">\n                <div className='chat-messages' ref={this.divChatMessages}>\n                    {this.props.messages.map((item) =>\n                        <Message\n                            key={item.id}\n                            from={item.from}\n                            message={item.message}\n                            time={item.time}\n                            user={this.props.user}\n                        />\n                    )\n                    }\n\n                </div>\n            </div>\n        );\n    }\n};\n","import React, { Component } from 'react';\n\nexport default class SendMessage extends Component {\n    state = {\n        inputValue: '',\n    }\n\n    textInputChange = e => {\n        this.setState({\n            inputValue: e.target.value,\n        })\n    }\n\n    render() {\n        return (\n            <div className=\"send-message\">\n                <form className='send-message__form'>\n                    <input\n                        className='send-message__input'\n                        type='text'\n                        value={this.state.inputValue}\n                        placeholder='Type you message'\n                        onChange={this.textInputChange}\n                    />\n                    <input\n                        className='send-message__submit'\n                        type=\"submit\"\n                        value='send'\n                        onClick={(e) => {\n                            e.preventDefault();\n                            this.setState({\n                                inputValue: '',\n                            })\n                            this.props.handleClick(this.state.inputValue);\n                        }}\n                    />\n                </form>\n            </div>\n        );\n    }\n}\n","import React, { Component } from 'react';\r\n\r\nexport default class Login extends Component {\r\n    state = {\r\n        inputValue: '',\r\n    }\r\n\r\n    changeInput = e => {\r\n        this.setState({\r\n            inputValue: e.target.value,\r\n        })\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <div className='login'>\r\n                <h1>Welcome to RS School Chat</h1>\r\n                <form className='login__form'>\r\n                    <input\r\n                        className='login__input'\r\n                        type='text'\r\n                        value={this.state.inputValue}\r\n                        placeholder='Enter you name'\r\n                        onChange={this.changeInput}\r\n                    />\r\n                    <input\r\n                        className='btn-sing-in'\r\n                        type=\"submit\"\r\n                        value='Sing in'\r\n                        onClick={(e) => {\r\n                            e.preventDefault();\r\n                            this.setState({\r\n                                inputValue: '',\r\n                            })\r\n                            this.props.handleSingIn(this.state.inputValue);\r\n                        }}\r\n                    />\r\n                </form>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}","const notify = () => {\n    if (Notification.permission === \"granted\") {\n        const notification = new Notification('New message', {\n            tag: \"message\",\n        });\n        setTimeout(notification.close.bind(notification), 4000);\n        notify.onclick = () => window.open(process.env.PUBLIC_URL);\n    }\n    else if (Notification.permission !== 'denied') {\n        Notification.requestPermission();\n    }\n};\n\n\nexport default notify;\n","import React, { Component } from 'react';\nimport ReconnectingWebSocket from 'reconnecting-websocket';\nimport User from './User';\nimport Chat from './Chat';\nimport SendMessage from './SendMessage';\nimport Login from './Login';\nimport notify from '../utils'\n\nexport default class App extends Component {\n    state = {\n        userName: '',\n        status: false,\n        messages: [],\n        notifications: false,\n    }\n\n    ws = new ReconnectingWebSocket(\n        \"wss://wssproxy.herokuapp.com/\",\n        [],\n        {\n            connectionTimeout: 3000,\n        });\n\n    handleSingIn = (value) => {\n        this.setState({\n            userName: value,\n        });\n        if (value !== '') localStorage.setItem('userName', JSON.stringify(value));\n    }\n\n    handleLogOut = () => {\n        this.setState({\n            userName: '',\n        });\n        localStorage.clear();\n    }\n\n    handleClick = (value) => {\n        this.ws.send(JSON.stringify({ from: this.state.userName, message: value }));\n    }\n\n    componentDidMount() {\n        this.setState(\n            {\n                userName: JSON.parse(localStorage.getItem('userName')),\n            }\n        );\n        this.ws.onopen = e => {\n            this.setState({\n                status: true\n            });\n            console.log('WebSocket: Connection established');\n        }\n\n        this.ws.onmessage = e => {\n            if (this.state.notifications) {\n                notify();\n            }\n            this.setState({\n                messages: this.state.messages.concat(JSON.parse(e.data).reverse()),\n            });\n        }\n\n        this.ws.onclose = e => {\n            if (e.wasClean) {\n                console.log('WebSocket: Connection closed cleanly');\n            } else {\n                console.log('WebSocket: Connection break');\n            }\n            console.log('WebSocket: Code: ' + e.code + ' cause: ' + e.reason);\n            this.setState({\n                status: false,\n            });\n        }\n\n        this.ws.onerror = (error) => {\n            console.log(\"WebSocket: Error \" + error.message);\n        }\n\n        window.onfocus = () => {\n            this.setState({\n                notifications: false,\n            });\n        }\n\n        window.onblur = () => {\n            this.setState({\n                notifications: true,\n            });\n        }\n    }\n\n    render() {\n        return (\n            !this.state.userName ? <Login handleSingIn={this.handleSingIn} /> :\n                (< div className=\"App\" >\n                    <User status={this.state.status} userName={this.state.userName} handleLogOut={this.handleLogOut} />\n                    <Chat messages={this.state.messages} user={this.state.userName} />\n                    <SendMessage handleClick={this.handleClick} />\n                </div >)\n        )\n    }\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}